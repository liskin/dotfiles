# authoring commits and patches
[user]
	name = Tomas Janousek
	email = tomi@nomi.cz
	signingKey = 639DFD7BBFF09178
[sendemail]
	smtpserver = /usr/bin/msmtp

# colors
[color]
	ui = true
[color "diff"]
	new = cyan bold #17
	old = red bold #52
	meta = green bold
	frag = yellow bold
	commit = white bold
	newMoved = 157 bold
	newMovedAlternative = 49 bold
	oldMoved = 166 bold
	oldMovedAlternative = 163 bold
[color "status"]
	added = cyan bold
	changed = red bold
	untracked = yellow bold
[color "branch"]
	upstream = brightgreen

# aliases
[alias]
	# mega useful aliases with cool names
	puf = push --force-with-lease
	resign = rebase -f --gpg-sign --keep-base
	# nicer git log
	lg = log --color --graph --decorate
	lgshort = log --color --graph --decorate --pretty=tformat:'%h\t%G? %aN\t%C(bold)%s%C(yellow)%d'
	# word diffing
	lgwdiff = log --color --graph --decorate -p --word-diff=color -w
	wdiff = -c pager.diff='less -FRX' diff --word-diff=color -w
	wshow = show --word-diff=color -w
	# git-dotfiles status alternatives
	unstatus = -c status.showUntrackedFiles=normal status
	unigstatus = "!git ls-files | sed -n -e 's|^|./|; s|/\\.gitignore$||p' | xargs git unstatus"

# assortment of uncategorised settings
[push]
	default = upstream
[pull]
	rebase = true
[rebase]
	autoSquash = true
	autoStash = true
	updateRefs = true
[branch]
	autosetuprebase = always
[init]
	defaultBranch = main
[mergetool]
	keepBackup = false
[merge]
	tool = nvimdiff
	guitool = kdiff3
	suppressDest = master
	suppressDest = main
[diff]
	tool = meld
	algorithm = histogram
	compactionHeuristic = true
	indentHeuristic = true
	colorMoved = default
	colorMovedWS = allow-indentation-change
	srcPrefix = ./
	dstPrefix = ./
[diff "hex"]
	textconv = hexdump -v -C
[core]
	pager = less -FRX --tabs=1,5
	hooksPath = ~/.config/git/hooks
[stash]
	showPatch = true
[svn]
	pushmergeinfo = true
[commit]
	verbose = 1
	#cleanup = scissors
[submodule]
	fetchJobs = 0
[status]
	submoduleSummary = true
[fetch]
	prune = true
	writeCommitGraph = true
[completion]
	commands = ls-files absorb
[gui]
	fontdiff = -family \"DejaVu Sans Mono\" -size 11 -weight normal -slant roman -underline 0 -overstrike 0
	spellingdictionary = en_GB
[url "ssh://git@github.com/"]
	pushInsteadOf = https://github.com/

# commit message helpers (see ~/.vim/ftplugin/gitcommit/liskin.vim)
[alias]
	fixes = -c core.abbrev=12 log -1 --pretty=fixes
	co-authored-by = log -1 --pretty=co-authored-by --regexp-ignore-case --author
	lgmarkdown = "log --reverse --pretty=format:'#### [%s](../commit/%H)%n%n%b'"
[pretty]
	fixes = Fixes: %h (\"%s\")
	co-authored-by = Co-authored-by: %an <%ae>

# delta config
[interactive]
	diffFilter = delta
[pager]
	diff = delta
	show = delta
[delta]
	features = diff-highlight
	tabs = 4
[delta "diff-highlight"]
	color-only = true
	commit-style = raw

# delta side-diffing
[alias]
	si-diff = -c pager.diff='delta --features=side' diff
	si-show = -c pager.show='delta --features=side' show
	si-range-diff = -c pager.range-diff='git-range-diff-delta-preproc | delta --features=side-range-diff' range-diff
[delta "side"]
	side-by-side = true
	paging = always
	commit-style = raw
	file-style = bold 39 235
	file-decoration-style = 39 235 ul ol
	hunk-header-decoration-style = 245 235 box
	hunk-header-line-number-style = 245 235
	hunk-header-style = syntax 235
	line-numbers-left-style = bold 245 233
	line-numbers-right-style = bold 245 233
	line-numbers-minus-style = 88 233
	line-numbers-zero-style = 240 233
	line-numbers-plus-style = 28 233
	# colorMoved - newMoved, newMovedAlternative, oldMoved, oldMovedAlternative:
	map-styles = bold 157 => syntax 24, bold 49 => syntax 29, bold 166 => syntax 54, bold 163 => syntax 89
	syntax-theme = zenburn
[delta "side-nonum"]
	features = side
	line-numbers-left-format = ""
	line-numbers-right-format = "â”‚ "
	line-numbers-right-style = 245
	file-decoration-style = 39 235
[delta "side-range-diff"]
	features = side-nonum
	file-style = omit

# tig config
[tig]
	tab-size = 4
	blame-options = -C -C -C
	mouse = true
	wrap-lines = true
	diff-highlight = true
[tig "bind"]
	generic = e !>tmux-new-window-or-exec nvim +"%(lineno)" "%(file)"
	generic = E !>tmux-new-window-or-exec nvim +"%(lineno)" "fugitive://%(repo:git-dir)//%(commit)/%(file)"
	generic = <Ctrl-S> !>tmux-new-window-or-exec git si-show "%(commit)"
	generic = T !>git notes edit "%(commit)"

# workaround for gh's "No default remote repository has been set for this directory."
# NB: never run "gh repo fork" as that renames origin, use the "gh fork" alias
[remote "origin"]
	gh-resolved = base

# includes
[includeIf "gitdir:~/src-haskell/xmonad*/"]
	path = ~/.config/git/include/xmonad
[includeIf "gitdir:~/work/"]
	path = ~/work/.gitconfig
