#!/usr/bin/env -S jq -r -f

# inspired by https://news.ycombinator.com/item?id=25006277

def format_key: if . | test("\\W") then . | @json else . end;
def format_path: map(if type == "number" then "[\(.)]" else ".\(. | format_key)" end) | join("");
tostream | select(length == 2) | "\(.[0] | format_path) = \(.[1] | @json)"
